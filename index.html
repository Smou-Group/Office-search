<!doctype html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Ø¨Ø­Ø« Ø§Ù„Ù…Ù‚Ø§ÙˆÙ„Ø§Øª ÙˆØ§Ù„Ø§Ø³ØªØ´Ø§Ø±ÙŠ</title>

<style>
  :root{--brand:#0f5c6e;}
  body{font-family: Tahoma, Arial, sans-serif; background:#f7f7f7; padding:20px; margin:0;}
  .card{max-width:1000px;margin:0 auto;background:#fff;border-radius:14px;box-shadow:0 10px 30px rgba(0,0,0,.08);padding:18px;}
  h2{text-align:center;margin:0 0 12px}

  .header{display:flex;flex-direction:column;align-items:center;gap:10px;margin-bottom:8px}
  .logo{width:110px;height:auto}
  .brandLine{font-size:13px;color:#666}

  .row{display:flex;gap:12px;flex-wrap:wrap;align-items:center;justify-content:center}
  input[type="text"]{padding:12px 14px;min-width:280px;border:1px solid #ddd;border-radius:10px;font-size:16px}
  input[type="text"]:focus{border-color:var(--brand);box-shadow:0 0 0 3px rgba(15,92,110,.15);outline:none}

  .note{text-align:center;margin-top:10px;color:#666}
  .pill{display:inline-block;background:rgba(15,92,110,.08);color:var(--brand);padding:6px 10px;border-radius:999px;font-size:13px}

  table{width:100%;border-collapse:collapse;margin-top:14px}
  th,td{border:1px solid #e2e2e2;padding:10px;text-align:right}
  th{background:var(--brand);color:#fff;position:sticky;top:0}
  tr:nth-child(even){background:#fafafa}

  .actions{display:flex;gap:8px;justify-content:center;margin-top:10px}
  button{border:0;border-radius:10px;padding:10px 12px;cursor:pointer}
  .btn2{background:#eee}
  .hidden{display:none}

  @media print{
    .actions,.row{display:none !important;}
    th{position:static}
  }
</style>
</head>

<body>
<div class="card">

  <div class="header">
    <img class="logo" src="logo.png" alt="SMOU Logo">
    <div class="brandLine">SMOU GROUP</div>
  </div>

  <h2>ðŸ”Ž Ø§Ù„Ø¨Ø­Ø« Ø¨Ø§Ø³Ù… Ø§Ù„Ù…ÙƒØªØ¨ / Ø´Ø±ÙƒØ© Ø§Ù„Ù…Ù‚Ø§ÙˆÙ„Ø§Øª</h2>

  <div class="row">
    <input id="search" type="text" placeholder="Ø§ÙƒØªØ¨ Ø§Ø³Ù… Ø§Ù„Ù…ÙƒØªØ¨ Ø£Ùˆ Ø§Ù„Ø´Ø±ÙƒØ©" autocomplete="off">
  </div>

  <div class="note" id="info">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...</div>

  <div class="actions">
    <button class="btn2" id="clearBtn">Ù…Ø³Ø­ Ø§Ù„Ø¨Ø­Ø«</button>
    <button class="btn2" id="printBtn">Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„Ù†ØªØ§Ø¦Ø¬</button>
  </div>

  <table id="table" class="hidden">
    <thead></thead>
    <tbody></tbody>
  </table>

</div>

<script>
let data = [];
let headers = [];
let SEARCH_COLS = [];

const info = document.getElementById("info");
const table = document.getElementById("table");
const thead = table.querySelector("thead");
const tbody = table.querySelector("tbody");
const searchInput = document.getElementById("search");

const norm = s => (s ?? "")
  .toString()
  .replace(/[\u064B-\u0652]/g, "")
  .trim()
  .replace(/\s+/g, " ")
  .toLowerCase();

function parseCSV(text){
  const lines = text.replace(/\r/g,"").trim().split("\n");
  headers = lines[0].split(",");
  const rows = [];
  for(let i=1;i<lines.length;i++){
    const cols = lines[i].split(",");
    const obj = {};
    headers.forEach((h,idx)=>obj[h.trim()] = (cols[idx]||"").trim());
    rows.push(obj);
  }
  return rows;
}

function detectSearchColumns(){
  const cols = [];
  headers.forEach(h=>{
    if(h.includes("Ù…Ù‚Ø§ÙˆÙ„") || h.includes("Ù…Ù‚Ø§ÙˆÙ„Ø§Øª"))
      cols.push(h.trim());
    if(h.includes("Ø§Ø³ØªØ´"))
      cols.push(h.trim());
  });
  return cols;
}

function render(rows){
  if(!rows.length){
    table.classList.add("hidden");
    return;
  }
  thead.innerHTML = "<tr>"+headers.map(h=>`<th>${h}</th>`).join("")+"</tr>";
  tbody.innerHTML = rows.map(r =>
    "<tr>"+headers.map(h=>`<td>${r[h]||""}</td>`).join("")+"</tr>"
  ).join("");
  table.classList.remove("hidden");
}

function search(){
  const q = norm(searchInput.value);
  if(!q){ render([]); return; }

  const res = data.filter(r =>
    SEARCH_COLS.some(col => norm(r[col]).includes(q))
  );

  info.textContent = res.length ? `Ø¹Ø¯Ø¯ Ø§Ù„Ù†ØªØ§Ø¦Ø¬: ${res.length}` : "Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬";
  render(res);
}

/* âœ… ØªØ­Ù…ÙŠÙ„ Ù…Ù† office.csv */
fetch("office.csv?v="+Date.now())
.then(r=>r.text())
.then(t=>{
  data = parseCSV(t);
  SEARCH_COLS = detectSearchColumns();
  info.textContent = "Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¬Ø§Ù‡Ø²Ø© âœ”ï¸";
})
.catch(()=>info.textContent="ØªØ¹Ø°Ø± ØªØ­Ù…ÙŠÙ„ Ù…Ù„Ù office.csv");

searchInput.addEventListener("input",search);
document.getElementById("clearBtn").onclick=()=>{searchInput.value="";search();}
document.getElementById("printBtn").onclick=()=>window.print();
</script>

</body>
</html>
